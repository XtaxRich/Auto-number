# 视频文件自动重命名工具

## 功能说明

这个工具可以监控指定文件夹中的视频文件，当有新文件下载完成时，自动将其重命名为"章.节-序号"的格式。

例如：
- 第5章第1节的视频会被命名为：`5.1-1.mp4`、`5.1-2.mp4`、`5.1-3.mp4` 等
- 序号会自动递增，从1开始

## 支持的视频格式

- .mp4
- .avi
- .mkv
- .mov
- .wmv
- .flv
- .webm
- .m4v
- .3gp
- .mpg
- .mpeg

## 使用方法

### 方法一：使用批处理文件（推荐）

1. 双击运行 `run_video_renamer.bat`
2. 按提示输入：
   - 要监控的文件夹路径（例如：`D:\Downloads\Videos`）
   - 章数（例如：`5`）
   - 节数（例如：`1`）
3. 程序开始监控，将新下载的视频文件自动重命名
4. 按 `Ctrl+C` 停止监控

### 方法二：直接使用PowerShell

```powershell
.\video_renamer.ps1 -TargetPath "D:\Downloads\Videos" -Chapter 5 -Section 1
```

## 注意事项

1. **文件夹路径**：确保输入的文件夹路径存在且可访问
2. **权限**：如果遇到权限问题，请以管理员身份运行
3. **文件占用**：工具会等待文件下载完成后再进行重命名
4. **已重命名文件**：如果文件已经是目标格式，会自动跳过
5. **序号连续性**：程序会自动检测已存在的文件，确保序号连续

## 示例场景

假设你要下载第5章第1节的视频课程：

1. 运行工具，设置章数为5，节数为1
2. 工具开始监控下载文件夹
3. 当你下载视频时，文件会自动重命名：
   - `乱码文件名1.mp4` → `5.1-1.mp4`
   - `乱码文件名2.mp4` → `5.1-2.mp4`
   - `乱码文件名3.mp4` → `5.1-3.mp4`

## 故障排除

### 问题：PowerShell执行策略限制
**解决方案**：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 问题：文件重命名失败
**可能原因**：
- 文件正在被其他程序使用
- 权限不足
- 目标文件名已存在

### 问题：监控不生效
**检查项目**：
- 文件夹路径是否正确
- 是否有足够的权限访问该文件夹
- 文件是否为支持的视频格式

## 技术特性

- 实时文件系统监控
- 智能序号管理
- 多种视频格式支持
- 重复文件检测
- 错误处理和日志输出